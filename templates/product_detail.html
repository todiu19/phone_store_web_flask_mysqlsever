{% extends "base.html" %}

{% block title %}{{ product.name }} - PhoneStore{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="row">
        <!-- Product Images -->
        <div class="col-lg-6">
            <div class="product-image-container">
                <img src="{{ url_for('static', filename=product.image) }}" 
                     alt="{{ product.name }}" 
                     class="img-fluid rounded shadow-lg">
            </div>
        </div>
        
        <!-- Product Info -->
        <div class="col-lg-6">
            <div class="product-info">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Trang chủ</a></li>
                        <li class="breadcrumb-item"><a href="{{ url_for('search', category=product.category_id) }}">{{ product.category_name }}</a></li>
                        <li class="breadcrumb-item active">{{ product.name }}</li>
                    </ol>
                </nav>
                
                <h1 class="product-title">{{ product.name }}</h1>
                <p class="text-muted">{{ product.brand }} {{ product.model }}</p>
                
                <div class="price-section mb-4">
                    <h2 class="text-danger">{{ "{:,.0f}".format(product.price) }}₫</h2>
                    {% if product.stock > 0 %}
                    <span class="badge bg-success fs-6">Còn hàng ({{ product.stock }} sản phẩm)</span>
                    {% else %}
                    <span class="badge bg-danger fs-6">Hết hàng</span>
                    {% endif %}
                </div>
                
                <!-- Product Specifications -->
                <div class="specifications mb-4">
                    <h5>Thông số kỹ thuật</h5>
                    <div class="row">
                        <div class="col-sm-6">
                            <p><strong>Màu sắc:</strong> {{ product.color }}</p>
                            <p><strong>Dung lượng:</strong> {{ product.storage }}</p>
                        </div>
                        <div class="col-sm-6">
                            <p><strong>Thương hiệu:</strong> {{ product.brand }}</p>
                            <p><strong>Model:</strong> {{ product.model }}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Add to Cart -->
                {% if product.stock > 0 %}
                <form id="addToCartForm" class="mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-4">
                            <label for="quantity" class="form-label">Số lượng:</label>
                            <input type="number" id="quantity" name="quantity" class="form-control" 
                                   value="1" min="1" max="{{ product.stock }}">
                        </div>
                        <div class="col-md-8">
                            <button type="button" class="btn btn-primary btn-lg w-100" 
                                    onclick="addToCart({{ product.id }}, document.getElementById('quantity').value)">
                                <i class="fas fa-cart-plus me-2"></i>Thêm vào giỏ hàng
                            </button>
                        </div>
                    </div>
                </form>
                {% else %}
                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    Sản phẩm hiện đang hết hàng. Vui lòng liên hệ để được thông báo khi có hàng.
                </div>
                {% endif %}
                
                <!-- Product Description -->
                <div class="product-description">
                    <h5>Mô tả sản phẩm</h5>
                    <p>{{ product.description }}</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Related Products -->
    {% if related_products %}
    <div class="related-products mt-5">
        <h3 class="mb-4">Sản phẩm liên quan</h3>
        <div class="row">
            {% for related in related_products %}
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 product-card">
                    <div class="position-relative">
                        <img src="{{ url_for('static', filename=related.image) }}" 
                             class="card-img-top" alt="{{ related.name }}" 
                             style="height: 200px; object-fit: cover;">
                        {% if related.stock > 0 %}
                        <span class="badge bg-success position-absolute top-0 end-0 m-2">Còn hàng</span>
                        {% else %}
                        <span class="badge bg-danger position-absolute top-0 end-0 m-2">Hết hàng</span>
                        {% endif %}
                    </div>
                    <div class="card-body d-flex flex-column">
                        <h6 class="card-title">{{ related.name }}</h6>
                        <p class="card-text text-muted small">{{ related.brand }} {{ related.model }}</p>
                        <div class="mb-2">
                            <span class="badge bg-primary">{{ related.color }}</span>
                            <span class="badge bg-secondary">{{ related.storage }}</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mt-auto">
                            <h6 class="text-danger mb-0">{{ "{:,.0f}".format(related.price) }}₫</h6>
                            {% if related.stock > 0 %}
                            <button class="btn btn-primary btn-sm" onclick="addToCart({{ related.id }})">
                                <i class="fas fa-cart-plus"></i>
                            </button>
                            {% endif %}
                        </div>
                        <div class="mt-2">
                            <a href="{{ url_for('product_detail', product_id=related.id) }}" 
                               class="btn btn-outline-primary btn-sm w-100">
                                Xem chi tiết
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<style>
.product-image-container {
    position: sticky;
    top: 20px;
}

.product-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 1rem;
}

.price-section h2 {
    font-size: 2.5rem;
    font-weight: 700;
}

.specifications {
    background-color: #f8f9fa;
    padding: 1.5rem;
    border-radius: 0.5rem;
}

.product-description {
    background-color: #f8f9fa;
    padding: 1.5rem;
    border-radius: 0.5rem;
    margin-top: 2rem;
}

.product-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 20px rgba(0,0,0,0.15);
}
</style>
{% endblock %}

